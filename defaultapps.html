<!DOCTYPE html>
<html>
    <head>
        <script id="AppAssoc-basic" type="text/xmldata"> 
                <DefaultAssociations>
                    <Association Identifier="http" ProgId="IE.HTTP" ApplicationName="Internet Explorer" />
                    <Association Identifier="https" ProgId="IE.HTTPS" ApplicationName="Internet Explorer" />
                </DefaultAssociations>
        </script>
        <script id="AppAssoc-advanced" type="text/xmldata"> 
            <DefaultAssociations>
                <Association Identifier=".3gp2" ProgId="WMP11.AssocFile.3G2" ApplicationName="Windows Media Player" />
                <Association Identifier=".acrobatsecuritysettings" ProgId="AcroExch.acrobatsecuritysettings" ApplicationName="Adobe Acrobat Reader DC" />
                <Association Identifier=".api" ProgId="AcroExch.Plugin" />
                <Association Identifier=".bmp" ProgId="Paint.Picture" ApplicationName="Paint" />
                <Association Identifier=".dib" ProgId="Paint.Picture" ApplicationName="Paint" />
                <Association Identifier=".emf" ProgId="emffile" ApplicationName="Paint" />
                <Association Identifier=".epub" ProgId="AppXvepbp3z66accmsd0x877zbbxjctkpr6t" ApplicationName="Microsoft Edge" />
                <Association Identifier=".fdf" ProgId="AcroExch.FDFDoc" ApplicationName="Adobe Acrobat Reader DC" />
                <Association Identifier=".gif" ProgId="PBrush" ApplicationName="Paint" />
                <Association Identifier=".htm" ProgId="htmlfile" ApplicationName="Internet Explorer" />
                <Association Identifier=".html" ProgId="htmlfile" ApplicationName="Internet Explorer" />
                <Association Identifier=".ico" ProgId="PBrush" ApplicationName="Paint" />
                <Association Identifier=".jfif" ProgId="PBrush" ApplicationName="Paint" />
                <Association Identifier=".jpe" ProgId="PBrush" ApplicationName="Paint" />
                <Association Identifier=".jpeg" ProgId="PBrush" ApplicationName="Paint" />
                <Association Identifier=".jpg" ProgId="PBrush" ApplicationName="Paint" />
                <Association Identifier=".MP2" ProgId="WMP11.AssocFile.MP3" ApplicationName="Windows Media Player" />
                <Association Identifier=".mpeg" ProgId="WMP11.AssocFile.mpeg" ApplicationName="Windows Media Player" />
                <Association Identifier=".oxps" ProgId="Windows.XPSReachViewer" ApplicationName="XPS Viewer" />
                <Association Identifier=".pdf" ProgId="AcroExch.Document.DC" ApplicationName="Adobe Acrobat Reader DC" />
                <Association Identifier=".pdfxml" ProgId="AcroExch.pdfxml" ApplicationName="Adobe Acrobat Reader DC" />
                <Association Identifier=".pdx" ProgId="PDXFileType" ApplicationName="Adobe Acrobat Reader DC" />
                <Association Identifier=".png" ProgId="PBrush" ApplicationName="Paint" />
                <Association Identifier=".rle" ProgId="rlefile" ApplicationName="Paint" />
                <Association Identifier=".secstore" ProgId="AcroExch.SecStore" />
                <Association Identifier=".tif" ProgId="PBrush" ApplicationName="Paint" />
                <Association Identifier=".tiff" ProgId="PBrush" ApplicationName="Paint" />
                <Association Identifier=".txt" ProgId="txtfile" ApplicationName="Notepad" />
                <Association Identifier=".url" ProgId="IE.AssocFile.URL" ApplicationName="Internet Browser" />
                <Association Identifier=".website" ProgId="IE.AssocFile.WEBSITE" ApplicationName="Internet Explorer" />
                <Association Identifier=".wmf" ProgId="wmffile" ApplicationName="Paint" />
                <Association Identifier=".xdp" ProgId="AcroExch.XDPDoc" ApplicationName="Adobe Acrobat Reader DC" />
                <Association Identifier=".xfdf" ProgId="AcroExch.XFDFDoc" ApplicationName="Adobe Acrobat Reader DC" />
                <Association Identifier=".xps" ProgId="Windows.XPSReachViewer" ApplicationName="XPS Viewer" />
                <Association Identifier="http" ProgId="IE.HTTP" ApplicationName="Internet Explorer" />
                <Association Identifier="https" ProgId="IE.HTTPS" ApplicationName="Internet Explorer" />
                <Association Identifier="mailto" ProgId="Outlook.URL.mailto.15" ApplicationName="Outlook 2016" />
            </DefaultAssociations>
        </script>
        <title>DefaultApps Alpha</title>
        <div style="text-align: center;">
            <h1>DefaultApps Alpha</h1>
        </div>
        <div style="text-align: center;">
            <table style="margin: 0 auto">
                <tr>
                    <td><input type="button" value="Basic" onclick="clearBox(), basic()"></td>
                    <td><input type="button" value="Advanced" onclick="clearBox(), advanced()"></td>
                </tr>
            </table>
        </div>
        <script>
        function clearBox()
        {
            document.getElementById("data").innerHTML = "";
        }

        function createTable(table, headRow){
            table.style = "margin: 0 auto";
            headRow.style = "background-color: slategrey";

            var selection = document.createElement("th");
            var identifier = document.createElement("th");
            var progid = document.createElement("th");
            var appname = document.createElement("th");

            selection.innerHTML = "Selection";
            identifier.innerHTML = "Extention";
            progid.innerHTML = "Program ID";
            appname.innerHTML = "Application Name";

            headRow.appendChild(selection);
            headRow.appendChild(identifier);
            headRow.appendChild(progid);
            headRow.appendChild(appname);
            table.appendChild(headRow);
            document.getElementById("data").appendChild(table); 
        }

        function sort(xmldoc, table){
            for (var i = 0; i <  xmldoc.getElementsByTagName("Association").length; i++) {
                var row = document.createElement("tr");
                if (i % 2 == 0) {
                    row.style = "background-color: darkgrey";
                }

                var columns = new Array();
                for (var j = 0; j < 4; j++) {
                    columns[j] = document.createElement("td");
                    row.appendChild(columns[j]);
                }

                // Check Box
                var chkbox = document.createElement("input");
                chkbox.type = "checkbox";
                columns[0].appendChild(chkbox);

                // Identifier
                columns[1].innerHTML =  xmldoc.getElementsByTagName("Association")[i].getAttribute("Identifier");

                // Program ID
                columns[2].innerHTML =  xmldoc.getElementsByTagName("Association")[i].getAttribute("ProgId");

                // Application Name
                columns[3].innerHTML =  xmldoc.getElementsByTagName("Association")[i].getAttribute("ApplicationName");
                table.appendChild(row);
            }
        }

        function basic(){
            var basicxml = document.getElementById("AppAssoc-basic").innerHTML;
            // Create DOMParser object and use it to get an XMLDocument object
            var parser = new DOMParser();
            var basicxmlDoc = parser.parseFromString(basicxml, "text/xml");
            var dataTable = document.createElement("table");
            var headerRow = document.createElement("tr");

            createTable(dataTable, headerRow);
            sort(basicxmlDoc, dataTable);
        }
        function advanced(){
            var advancedxml = document.getElementById("AppAssoc-advanced").innerHTML;
            // Create DOMParser object and use it to get an XMLDocument object
            var parser = new DOMParser();
            var advancedxmldoc = parser.parseFromString(advancedxml, "text/xml");
            var dataTable = document.createElement("table");
            var headerRow = document.createElement("tr");

            createTable(dataTable, headerRow);
            sort(advancedxmldoc, dataTable);
        }
    </script>
    </head>
    <body style="background-color: lightgray" onload="basic()">
        <div id="data"></div>
    </body>
</html>